<!-- templates/agregar_ruta.html -->
{% extends "base.html" %}


{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Agregar Ruta</h1>
</div>

<div class="card">
    <div class="card-body">
        <form method="POST">
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="origen" class="form-label">Origen</label>
                        <input type="text" class="form-control" name="origen" required>
                    </div>
                    <div class="mb-3">
                        <label for="destino" class="form-label">Destino</label>
                        <input type="text" class="form-control" name="destino" required>
                    </div>
                    <div class="mb-3">
                        <label for="fecha" class="form-label">Fecha</label>
                        <input type="date" class="form-control" name="fecha" required>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="hora" class="form-label">Hora</label>
                        <input type="time" class="form-control" name="hora" required>
                    </div>
                    <div class="mb-3">
                        <label for="bus_id" class="form-label">Seleccionar Bus</label>
                        <select class="form-control" id="bus_id" name="bus_id" required>
                            <option value="" disabled selected>-- Seleccione un bus --</option>
                            {% for bus in buses %}
                            <option value="{{ bus._id }}" data-asientos="{{ bus.asientos }}">
                                {{ bus.marca }} - {{ bus.placa }} (Asientos: {{ bus.asientos }})
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="asientos" class="form-label">NÃºmero de Asientos</label>
                        <input type="number" class="form-control" id="asientos" name="asientos" readonly required>
                    </div>
                    <div class="mb-3">
                        <label for="precio_base" class="form-label">Precio Base</label>
                        <input type="number" step="0.01" class="form-control" name="precio_base" required>
                    </div>
                </div>
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Agregar Ruta
                </button>
                <a href="{{ url_for('mostrar_rutas') }}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Volver
                </a>
            </div>
        </form>
    </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const busSelect = document.getElementById('bus_id');
    const asientosInput = document.getElementById('asientos');

    busSelect.addEventListener('change', () => {
      const selectedOption = busSelect.options[busSelect.selectedIndex];
      const asientos = selectedOption.getAttribute('data-asientos') || '';
      asientosInput.value = asientos;
    });
  });
</script>
{% endblock %}
